<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>QuÃªn máº­t kháº©u</title>
</head>

<body>

    <h2>QuÃªn máº­t kháº©u</h2>

    <input type="email" id="email" placeholder="Nháº­p email">
    <br><br>
    <button onclick="sendReset()">Gá»­i yÃªu cáº§u</button>

    <!-- ğŸ”— LINK RESET (DEV MODE) -->
    <p id="reset-box" style="display:none;">
        ğŸ‘‰ <a id="reset-link" href="#" target="_blank">Nháº¥n vÃ o Ä‘Ã¢y Ä‘á»ƒ Ä‘áº·t láº¡i máº­t kháº©u</a>
    </p>

    <p>
        <button>
            <a href="../Login/login.html">â¬…ï¸ Quay láº¡i trang Ä‘Äƒng nháº­p</a>
        </button>
    </p>

    <script>
function sendReset() {
    const email = document.getElementById("email").value.trim();

    if (!email) {
        alert("Vui lÃ²ng nháº­p email");
        return;
    }

    fetch("/project/Backend/forgot_password.php", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email })
    })
    .then(res => res.text())
    .then(text => {
        let data;
        try {
            data = JSON.parse(text);
        } catch {
            console.error(text);
            alert("Server tráº£ vá» dá»¯ liá»‡u khÃ´ng há»£p lá»‡");
            return;
        }

        alert(data.message);

        if (data.success && data.link) {
            const box = document.getElementById("reset-box");
            const link = document.getElementById("reset-link");

            link.href = data.link;
            link.textContent = "Nháº¥n vÃ o Ä‘Ã¢y Ä‘á»ƒ Ä‘áº·t láº¡i máº­t kháº©u";
            box.style.display = "block";
        }
    })
    .catch(() => {
        alert("Lá»—i káº¿t ná»‘i server");
    });
}
</script>


</body>

</html>
